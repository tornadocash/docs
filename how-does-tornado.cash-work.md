# Як працює Tornado.Cash?

Перш ніж зануритися в підручники, що пояснюють та полегшують використання Tornado.Cash, ось загальний огляд глобального функціонування протоколу.

### Глобальний огляд функціонування Tornado.Cash

Для забезпечення конфіденційності Tornado.Cash **використовує розумні контракти, які приймають депозити токенів з однієї адреси та дозволяють їх вилучати з іншої адреси**. Ці розумні контракти працюють як пули, які змішують усі депоновані активи. 

Як тільки засоби виводяться з пулу з нової адреси, зв'язок між джерелом і отримувачами в мережі блокчейн розривається. Таким чином, виведені криптоактиви анонімізуються. 

Коли користувач вкладає кошти в пул \ (він же депозит \), генерується приватна нотатка (note). Ця приватна записка (note) працює як приватний ключ для доступу користувача до цих коштів пізніше. Щоб вивести їх, той самий користувач може використати іншу адресу - стару чи нову - і повернути свої кошти завдяки цьому приватному ключу.

Сила захисту анонімності такого протоколу природно випливає з його кількості користувачів та розміру його пулу. Чим більше користувачів вносить гроші в пул, тим краще. Однак, щоб зберегти конфіденційність та анонімність, користувач повинен мати на увазі деякі основні правила, такі як:

* Використовувати ретранслятор (relayer) для оплати газу при знятті;
* Залишати деякий проміжок часу між внесенням депозиту та виведенням коштів;
* Змішувати свої активи разом із активами інших користувачів - чекаючи кількох транзакцій, перш ніж вивести свої активи.

_Додаткові рекомендації:_ [_Поради як залишатися анонімними_](tips-to-remain-anonymous.md)_._

### Внесок процесу zk-SNARK та хешування

Tornado.Cash використовує Zero-Knowledge Succinct Non-Interactive Argument of Knowledge \(також званий zk-SNARK\) для перевірки та дозволу транзакцій. 

Щоб обробити депозит, Tornado.Cash генерує випадкову область байтів, обчислює її через [Pederson Hash](https://iden3-docs.readthedocs.io/en/latest/iden3_repos/research/publications/zkproof-standards-workshop-2/pedersen-hash/pedersen.html) \(оскільки він більш сумісний з zk-SNARK\), а потім надішле токен та хеш 20 mimc до смарт-контракту. Потім контракт додасть його до дерева Merkle.

Для обробки виводу коштів одна і та ж область байтів поділяється на дві окремі частини: **секретну** з одного боку та **нульову** з іншого. Нуліфікатор хешований. Цей нуліфікатор-це загальнодоступний вхід, який надсилається по мережі (on-chain) для перевірки за допомогою розумного контракту та даних дерева Меркла. Це наприклад, дозволяє уникнути подвійних витрат.

Завдяки zk-SNARK можна довести хеш 20 mimc вихідного зобов'язання та нуліфікатора без розкриття будь-якої інформації. Навіть якщо нуліфікатор є загальнодоступним, конфіденційність зберігається, оскільки неможливо пов’язати хешований нуліфікатор з початковим зобов’язанням. Крім того, навіть якщо інформація про те, що транзакція присутня в корені Merkle, інформація про точний шлях Merkle, тобто місцезнаходження транзакції, все ще залишається конфіденційною.

Депозити прості з технологічної точки зору, але дорогі з точки зору газу, оскільки їм потрібно обчислити 20 mimc hash та оновити дерево Меркла. А ось процес виводу активів навпаки, більш складний, але дешевший, оскільки газ потрібен лише для хеша нулліфікатора та доказу з нульовим розголошенням.



_Translated by_ [_**@chieftalion**_](https://torn.community/u/chieftalion/)

